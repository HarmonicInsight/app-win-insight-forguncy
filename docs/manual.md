# Forguncy Insight ユーザーマニュアル

**バージョン 1.0.0 | 対応: Forguncy 9.x**

---

## 目次

1. [クイックスタート](#1-クイックスタート)
2. [機能説明](#2-機能説明)
3. [ライセンス](#3-ライセンス)
4. [FAQ・トラブルシューティング](#4-faqトラブルシューティング)

---

## 1. クイックスタート

### 1.1 システム要件

| 項目 | 要件 |
|------|------|
| OS | Windows 10/11, macOS, Linux |
| Python | 3.8 以上 |
| 対応Forguncy | 9.x |
| メモリ | 4GB以上推奨 |

### 1.2 インストール

```bash
# 1. 必要なライブラリをインストール
pip install python-docx openpyxl

# 2. アプリケーションを起動
python ForguncyInsight.py
```

### 1.3 基本操作（3ステップ）

```
┌─────────────────────────────────────────────────────┐
│  Step 1: プロジェクトファイル(.fgcp)を選択          │
│          ↓                                          │
│  Step 2: 出力フォルダを指定                         │
│          ↓                                          │
│  Step 3: 「解析開始」ボタンをクリック               │
└─────────────────────────────────────────────────────┘
```

1. **ファイル選択**: 「参照...」ボタンをクリックし、Forguncyプロジェクトファイル（.fgcp）を選択
2. **出力先指定**: 仕様書の出力先フォルダを指定（デフォルト: ドキュメントフォルダ）
3. **解析実行**: 「解析開始」ボタンをクリック

解析完了後、指定フォルダに仕様書が生成されます。

---

## 2. 機能説明

### 2.1 プロジェクト解析

Forguncyプロジェクト（.fgcp）を解析し、以下の情報を抽出します：

| 解析対象 | 抽出内容 |
|---------|---------|
| テーブル | 名前、カラム定義、データ型、必須/ユニーク制約、リレーション |
| ページ | 名前、種別（通常/マスターページ）、ボタン、数式 |
| ワークフロー | 状態、遷移、アクション、担当者、実行コマンド |
| サーバーコマンド | 名前、パラメータ、処理内容（SQL、テーブル操作等） |

#### 出力形式

| 形式 | 説明 | ライセンス |
|------|------|-----------|
| Word (.docx) | 正式な仕様書形式。目次、テーブル定義、画面一覧等を含む | Standard |
| Excel (.xlsx) | シート別に整理。サマリー、テーブル一覧、カラム定義、ER図(Mermaid) | Standard |

### 2.2 差分比較

2つのForguncyプロジェクトを比較し、変更点を検出します。

**使用シーン:**
- バージョン間の変更確認
- 本番環境と開発環境の差異確認
- リリース前の変更点レビュー

**検出項目:**

| カテゴリ | 検出内容 |
|---------|---------|
| テーブル | 追加・削除・変更（カラム変更含む） |
| ページ | 追加・削除 |
| サーバーコマンド | 追加・削除・変更（処理内容の差異） |

#### 操作手順

1. 「差分比較」タブを選択
2. 比較元ファイル（旧バージョン）を選択
3. 比較先ファイル（新バージョン）を選択
4. 「差分を比較」ボタンをクリック

結果は別ウィンドウに表示されます。

### 2.3 ER図出力

Excel出力時、「ER図(Mermaid)」シートにMermaid記法のER図コードを出力します。

**使用方法:**
1. Excel仕様書を生成
2. 「ER図(Mermaid)」シートを開く
3. コードをコピー
4. [Mermaid Live Editor](https://mermaid.live/) に貼り付け
5. 画像としてエクスポート

---

## 3. ライセンス

### 3.1 プラン比較

| 機能 | Free | Standard |
|------|:----:|:--------:|
| テーブル解析 | 5件まで | 無制限 |
| ページ解析 | 10件まで | 無制限 |
| サーバーコマンド解析 | 3件まで | 無制限 |
| ワークフロー解析 | 1件まで | 無制限 |
| Word出力 | - | ✓ |
| Excel出力 | - | ✓ |
| 差分比較 | - | ✓ |
| 商用利用 | - | ✓ |
| **価格** | 無料 | ¥49,800/年 |

### 3.2 ライセンスアクティベーション

1. 「ライセンス」タブを開く
2. ライセンスキーを入力
   - 形式: `INS-FORG-STD-XXXX-XXXX-XX`
3. 「アクティベート」ボタンをクリック

ライセンス情報はローカルに保存され、次回起動時に自動的に読み込まれます。

### 3.3 ライセンスキー形式

```
INS-FORG-STD-XXXX-XXXX-XX
│   │    │   │    │    └─ チェックサム(2文字)
│   │    │   │    └────── ランダム部(4文字)
│   │    │   └─────────── ランダム部(4文字)
│   │    └─────────────── ティア (STD/PRO/ENT)
│   └──────────────────── 製品コード (FORG)
└──────────────────────── プレフィックス (INS)
```

---

## 4. FAQ・トラブルシューティング

### Q1: 「openpyxlがインストールされていません」と表示される

**A:** Excel出力には openpyxl が必要です。以下のコマンドでインストールしてください：

```bash
pip install openpyxl
```

### Q2: 解析結果が途中で切れている

**A:** Free版には解析件数の制限があります。

| 項目 | Free版制限 |
|------|-----------|
| テーブル | 5件 |
| ページ | 10件 |
| サーバーコマンド | 3件 |
| ワークフロー | 1件 |

すべてのデータを解析するには、Standard版へのアップグレードが必要です。

### Q3: 文字化けが発生する

**A:** 以下を確認してください：

1. Forguncyプロジェクトが正常に保存されているか
2. .fgcpファイルが破損していないか
3. Python環境がUTF-8に対応しているか

### Q4: 新しいForguncyバージョンに対応していますか？

**A:** 現在の対応バージョン：

| バージョン | 対応状況 |
|-----------|---------|
| Forguncy 9.x | ✓ 対応 |
| Forguncy 10.x | 未確認（動作する可能性あり） |

新バージョンで問題が発生した場合は、サポートまでご連絡ください。

### Q5: ライセンスキーが無効と表示される

**A:** 以下を確認してください：

1. ライセンスキーが正しく入力されているか（コピー&ペースト推奨）
2. 有効期限が切れていないか
3. 製品コードが「FORG」であるか（他製品のキーは使用不可）

### Q6: エラー「No JSON object found」が表示される

**A:** .fgcpファイルの形式が想定と異なる可能性があります。

- Forguncyで一度プロジェクトを開き、再保存してお試しください
- 対応バージョン以外のForguncyで作成されたファイルの可能性があります

---

## サポート・お問い合わせ

- **メール**: support@example.com
- **バージョン情報**: v1.0.0
- **対応Forguncy**: 9.x

---

*© 2024 Forguncy Insight. All rights reserved.*
